
<!DOCTYPE HTML>
<html lang="us-en" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>07 Runtime · Composer 英文文档</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-prism/prism-solarizedlight.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="08-community.html" />
    
    
    <link rel="prev" href="06-config.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    
    
        
        <li>
            <a href="https://docs.khs1994.com" target="_blank" class="custom-link">Home</a>
        </li>
    
    

    
    <li class="divider"></li>
    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="./">
            
                <a href="./">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" >
            
                <span>
            
                    
                    Articles
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="articles/aliases.html">
            
                <a href="articles/aliases.html">
            
                    
                    Aliases
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="articles/authentication-for-private-packages.html">
            
                <a href="articles/authentication-for-private-packages.html">
            
                    
                    Authentication For Private Packages
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="articles/autoloader-optimization.html">
            
                <a href="articles/autoloader-optimization.html">
            
                    
                    Autoloader Optimization
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="articles/custom-installers.html">
            
                <a href="articles/custom-installers.html">
            
                    
                    Custom Installers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.5" data-path="articles/handling-private-packages.html">
            
                <a href="articles/handling-private-packages.html">
            
                    
                    Handling Private Packages
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6" data-path="articles/plugins.html">
            
                <a href="articles/plugins.html">
            
                    
                    Plugins
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.7" data-path="articles/repository-priorities.html">
            
                <a href="articles/repository-priorities.html">
            
                    
                    Repository Priorities
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.8" data-path="articles/resolving-merge-conflicts.html">
            
                <a href="articles/resolving-merge-conflicts.html">
            
                    
                    Resolving Merge Conflicts
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.9" data-path="articles/scripts.html">
            
                <a href="articles/scripts.html">
            
                    
                    Scripts
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.10" data-path="articles/troubleshooting.html">
            
                <a href="articles/troubleshooting.html">
            
                    
                    Troubleshooting
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.11" data-path="articles/vendor-binaries.html">
            
                <a href="articles/vendor-binaries.html">
            
                    
                    Vendor Binaries
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.12" data-path="articles/versions.html">
            
                <a href="articles/versions.html">
            
                    
                    Versions
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" >
            
                <span>
            
                    
                    Dev
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="dev/DefaultPolicy.html">
            
                <a href="dev/DefaultPolicy.html">
            
                    
                    Default Policy
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" >
            
                <span>
            
                    
                    Faqs
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="faqs/how-do-i-install-a-package-to-a-custom-path-for-my-framework.html">
            
                <a href="faqs/how-do-i-install-a-package-to-a-custom-path-for-my-framework.html">
            
                    
                    How Do I Install A Package To A Custom Path For My Framework
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="faqs/how-to-install-composer-programmatically.html">
            
                <a href="faqs/how-to-install-composer-programmatically.html">
            
                    
                    How To Install Composer Programmatically
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="faqs/how-to-install-untrusted-packages-safely.html">
            
                <a href="faqs/how-to-install-untrusted-packages-safely.html">
            
                    
                    How To Install Untrusted Packages Safely
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="faqs/should-i-commit-the-dependencies-in-my-vendor-directory.html">
            
                <a href="faqs/should-i-commit-the-dependencies-in-my-vendor-directory.html">
            
                    
                    Should I Commit The Dependencies In My Vendor Directory
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5" data-path="faqs/which-version-numbering-system-does-composer-itself-use.html">
            
                <a href="faqs/which-version-numbering-system-does-composer-itself-use.html">
            
                    
                    Which Version Numbering System Does Composer Itself Use
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.6" data-path="faqs/why-are-unbound-version-constraints-a-bad-idea.html">
            
                <a href="faqs/why-are-unbound-version-constraints-a-bad-idea.html">
            
                    
                    Why Are Unbound Version Constraints A Bad Idea
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.7" data-path="faqs/why-are-version-constraints-combining-comparisons-and-wildcards-a-bad-idea.html">
            
                <a href="faqs/why-are-version-constraints-combining-comparisons-and-wildcards-a-bad-idea.html">
            
                    
                    Why Are Version Constraints Combining Comparisons And Wildcards A Bad Idea
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.8" data-path="faqs/why-can't-composer-load-repositories-recursively.html">
            
                <a href="faqs/why-can't-composer-load-repositories-recursively.html">
            
                    
                    Why Can T Composer Load Repositories Recursively
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="fixtures/fixtures.html">
            
                <a href="fixtures/fixtures.html">
            
                    
                    Fixtures
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="01-basic-usage.html">
            
                <a href="01-basic-usage.html">
            
                    
                    01 Basic Usage
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="02-libraries.html">
            
                <a href="02-libraries.html">
            
                    
                    02 Libraries
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="03-cli.html">
            
                <a href="03-cli.html">
            
                    
                    03 Cli
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="04-schema.html">
            
                <a href="04-schema.html">
            
                    
                    04 Schema
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="05-repositories.html">
            
                <a href="05-repositories.html">
            
                    
                    05 Repositories
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="06-config.html">
            
                <a href="06-config.html">
            
                    
                    06 Config
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.12" data-path="07-runtime.html">
            
                <a href="07-runtime.html">
            
                    
                    07 Runtime
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13" data-path="08-community.html">
            
                <a href="08-community.html">
            
                    
                    08 Community
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="." >07 Runtime</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="runtime-composer-utilities">Runtime Composer utilities</h1>
<p>While Composer is mostly used around your project to install its dependencies,
there are a few things which are made available to you at runtime.</p>
<p>If you need to rely on some of these in a specific version, you can require
the <code>composer-runtime-api</code> package.</p>
<h2 id="autoload">Autoload</h2>
<p>The autoloader is the most used one, and is already covered in our
<a href="01-basic-usage.html#autoloading">basic usage guide</a>. It is available in all
Composer versions.</p>
<h2 id="installed-versions">Installed versions</h2>
<p>composer-runtime-api 2.0 introduced a new <code>Composer\InstalledVersions</code> class which offers
a few static methods to inspect which versions are currently installed. This is
automatically available to your code as long as you include the Composer autoloader.</p>
<p>The main use cases for this class are the following:</p>
<h3 id="knowing-whether-package-x-or-virtual-package-is-present">Knowing whether package X (or virtual package) is present</h3>
<pre class="language-"><code class="lang-php">\<span class="token package">Composer<span class="token punctuation">\</span>InstalledVersions</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">isInstalled</span><span class="token punctuation">(</span><span class="token single-quoted-string string">&apos;vendor/package&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// returns bool</span>
\<span class="token package">Composer<span class="token punctuation">\</span>InstalledVersions</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">isInstalled</span><span class="token punctuation">(</span><span class="token single-quoted-string string">&apos;psr/log-implementation&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// returns bool</span>
</code></pre>
<p>Note that this can not be used to check whether platform packages are installed.</p>
<h3 id="knowing-whether-package-x-is-installed-in-version-y">Knowing whether package X is installed in version Y</h3>
<blockquote>
<p><strong>Note:</strong> To use this, your package must require <code>&quot;composer/semver&quot;: &quot;^2.0&quot;</code>.</p>
</blockquote>
<pre class="language-"><code class="lang-php"><span class="token keyword">use</span> <span class="token package">Composer<span class="token punctuation">\</span>Semver<span class="token punctuation">\</span>VersionParser</span><span class="token punctuation">;</span>

\<span class="token package">Composer<span class="token punctuation">\</span>InstalledVersions</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">satisfies</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">VersionParser</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">&apos;vendor/package&apos;</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">&apos;2.0.*&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
\<span class="token package">Composer<span class="token punctuation">\</span>InstalledVersions</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">satisfies</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">VersionParser</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">&apos;psr/log-implementation&apos;</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">&apos;^1.0&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>This will return true if e.g. vendor/package is installed in a version matching
<code>2.0.*</code>, but also if the given package name is replaced or provided by some other
package.</p>
<h3 id="knowing-the-version-of-package-x">Knowing the version of package X</h3>
<blockquote>
<p><strong>Note:</strong> This will return <code>null</code> if the package name you ask for is not itself installed
but merely provided or replaced by another package. We therefore recommend using satisfies()
in library code at least. In application code you have a bit more control and it is less
important.</p>
</blockquote>
<pre class="language-"><code class="lang-php"><span class="token comment">// returns a normalized version (e.g. 1.2.3.0) if vendor/package is installed,</span>
<span class="token comment">// or null if it is provided/replaced,</span>
<span class="token comment">// or throws OutOfBoundsException if the package is not installed at all</span>
\<span class="token package">Composer<span class="token punctuation">\</span>InstalledVersions</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">getVersion</span><span class="token punctuation">(</span><span class="token single-quoted-string string">&apos;vendor/package&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<pre class="language-"><code class="lang-php"><span class="token comment">// returns the original version (e.g. v1.2.3) if vendor/package is installed,</span>
<span class="token comment">// or null if it is provided/replaced,</span>
<span class="token comment">// or throws OutOfBoundsException if the package is not installed at all</span>
\<span class="token package">Composer<span class="token punctuation">\</span>InstalledVersions</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">getPrettyVersion</span><span class="token punctuation">(</span><span class="token single-quoted-string string">&apos;vendor/package&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<pre class="language-"><code class="lang-php"><span class="token comment">// returns the package dist or source reference (e.g. a git commit hash) if vendor/package is installed,</span>
<span class="token comment">// or null if it is provided/replaced,</span>
<span class="token comment">// or throws OutOfBoundsException if the package is not installed at all</span>
\<span class="token package">Composer<span class="token punctuation">\</span>InstalledVersions</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">getReference</span><span class="token punctuation">(</span><span class="token single-quoted-string string">&apos;vendor/package&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h3 id="knowing-a-packages-own-installed-version">Knowing a package&apos;s own installed version</h3>
<p>If you are only interested in getting a package&apos;s own version, e.g. in the source of acme/foo you want
to know which version acme/foo is currently running to display that to the user, then it is
acceptable to use getVersion/getPrettyVersion/getReference.</p>
<p>The warning in the section above does not apply in this case as you are sure the package is present
and not being replaced if your code is running.</p>
<p>It is nonetheless a good idea to make sure you handle the <code>null</code> return value as gracefully as
possible for safety.</p>
<hr>
<p>A few other methods are available for more complex usages, please refer to the
source/docblocks of <a href="https://github.com/composer/composer/blob/master/src/Composer/InstalledVersions.php" target="_blank">the class itself</a>.</p>
<h2 id="platform-check">Platform check</h2>
<p>composer-runtime-api 2.0 introduced a new <code>vendor/composer/platform_check.php</code> file, which
is included automatically when you include the Composer autoloader.</p>
<p>It verifies that platform requirements (i.e. php and php extensions) are fulfilled
by the PHP process currently running. If the requirements are not met, the script
prints a warning with the missing requirements and exits with code 104.</p>
<p>To avoid an unexpected white page of death with some obscure PHP extension warning in
production, you can run <code>composer check-platform-reqs</code> as part of your
deployment/build and if that returns a non-0 code you should abort.</p>
<p>The default value is <code>php-only</code> which only checks the PHP version.</p>
<p>If you for some reason do not want to use this safety check, and would rather
risk runtime errors when your code executes, you can disable this by setting the
<a href="06-config.html#platform-check"><code>platform-check</code></a> config option to <code>false</code>.</p>
<p>If you want the check to include verifying the presence of PHP extensions,
set the config option to <code>true</code>.</p>
<p>&#x2190; <a href="06-config.html">Config</a>  |  <a href="08-community.html">Community</a> &#x2192;</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="06-config.html" class="navigation navigation-prev " aria-label="Previous page: 06 Config">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="08-community.html" class="navigation navigation-next " aria-label="Next page: 08 Community">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"07 Runtime","level":"1.12","depth":1,"next":{"title":"08 Community","level":"1.13","depth":1,"path":"08-community.md","ref":"08-community.md","articles":[]},"previous":{"title":"06 Config","level":"1.11","depth":1,"path":"06-config.md","ref":"06-config.md","articles":[]},"dir":"ltr"},"config":{"plugins":["-sharing","-highlight","-livereload","prism"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"prism":{"css":["prismjs/themes/prism-solarizedlight.css"]},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"Composer 英文文档","language":"us-en","links":{"sidebar":{"Home":"https://docs.khs1994.com"}},"gitbook":"*"},"file":{"path":"07-runtime.md","mtime":"2021-02-26T00:11:44.000Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2021-02-26T00:12:20.506Z"},"basePath":".","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="gitbook/gitbook.js"></script>
    <script src="gitbook/theme.js"></script>
    
        
        <script src="gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

